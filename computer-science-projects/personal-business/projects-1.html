<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <title>Personal</title>
		<link href="../img/SCM_logo.png" rel="icon" type="image/x-icon" 
        <meta name="description" content="">
		<!-- Mobile Specific Meta -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        
        <!-- <link rel="shortcut icon" href="img/favicon.png"> -->
        
        <link href='http://fonts.googleapis.com/css?family=Lato:300,400,700' rel='stylesheet'>
        
        <!-- Syntax Highlighter -->
        <link rel="stylesheet" type="text/css" href="../syntax-highlighter/styles/shCore.css" media="all">
        <link rel="stylesheet" type="text/css" href="../syntax-highlighter/styles/shThemeDefault.css" media="all">
		
		<!-- Font Awesome CSS-->
        <link rel="stylesheet" href="../css/font-awesome.min.css">
        <!-- Normalize/Reset CSS-->
		<link rel="stylesheet" href="../css/normalize.min.css">
		<!-- Main CSS-->
        <link rel="stylesheet" href="../css/main.css">
		
    </head>
	
    <body id="welcome">
    
        <aside class="left-sidebar">
            <div class="logo">
                <a href="#welcome">
                    <img src="../img/SCM_logo.png" alt="">
                </a>
            </div>
            <nav class="left-nav">
                <ul id="nav">
                    <li class="current"><a href="#welcome">Welcome</a></li>
					<li><a class="#" href="#firebase-login-register">Firbase | WEB User Registration System</a></li>
					<li><a class="indent" href="#firebase-login-page">Login Page</a></li>
					<li><a class="indent" href="#firebase-register-page">Register Page</a></li>
					<li><a class="indent" href="#firebase-css-code">CSS Code</a></li>
					<li><a class="#" href="#python-package-installer">Python Packages | Python Package Installer</a></li>
					<li><a class="#" href="#python-stock-web-scraper">Web Scraper | Python Stock Market Web Scraper</a></li>
					<li><a class="indent" href="#python-stock-web-scraper-initializer">Initializer</a></li>
					<li><a class="indent" href="#python-stock-web-scraper-stock-grabber">Stock Data Grabber</a></li>
                </ul>
            </nav>
        </aside>
		
		<div id="main-wrapper">
		    <div class="main-content">
		        <section id="welcome">
		            <div class="content-header">
		                <h1 class="big-title">Personal Projects</h1>
						</br>
						<u><a target="_blank" href="personal-contents.pdf"><h3>Click to View Table of Contents</h3></a></u>
						</br>
						<a class="dead-arrow" href="projects-1"><i class="fa fa-arrow-left"></i></a>
						<u><a class="" href="projects-1">1</a></u>
						<a class="dead-arrow" href="#"><i class="fa fa-arrow-right"></i></a>
		            </div>
		            <div class="welcome">
                        
                        <h2 class="twenty">Assignments and Projects I Work On For Personal Enjoyment.</h2>

                        <p>Programs and projects I felt were worth documenting/saving for the future. These aren't necessarily large or particularly important, but they show useful techniques or functions.</p>

                        <p>Some sections show whole programs or files, while other show only functions/methods that can be used in any program.</p>
		            </div>
		            
		            <div class="features">
		                <h2 class="twenty">This Page Features</h2>      
		                <ul>
                            <li>Firebase Login and Register System</li>
							<li>Automatic Python Package Installer</li>
		                </ul>
		            </div>

		        </section>	        
				
				<section id="firebase-login-register">
					<div class="content-header">
		                <h1>Firebase WEB User Registration System</h1>
						</br>
						<h3>Programming Languages : HTML CSS JavaScript</h3>
                    </div>
					<div class="welcome">                      
                        <h2 class="twenty">Simple Login and Registration System Using Firebase Databases</h2>
						<p>These files and programs show the use of Firebase databases to process user logins and registrations on the WEB.</p>
                        <p>Basic HTML and CSS are shown, input fields, buttons, and redirection. The Javascript is the primary focus of these programs.</p>
						<u><a href="https://firebase.google.com/" target="_blank">Google Firebase Website</a></u>
		            </div>
					<div class="welcome">       
                        <h2 class="twenty">Files Used / Created</h2>
                        <p>Download them below. Bold represents HTML files, unbold: CSS or Javascript files.</p>
		            </div>
					<div class="script-source">
		                <ul>
		                    <b><li><a href="project-files/page1/firebase-login-register/login" download>login.html</a></li></b>
							<b><li><a href="project-files/page1/firebase-login-register/register" download>register.html</a></li></b>
							<li><a href="project-files/page1/firebase-login-register/loginStyle.css" download>loginStyle.css</a></li>
		                </ul>
		            </div>
					<section id="firebase-login-page">
						<p class="addSpace">&nbsp;</p>
						<h2 class="title">HTML & Firebase Code | Login Page</h2>
						<p class="fifteen">This code shows a simple HTML Webpage for user logins using Firebase databases.</p>
						<pre class="brush: html">
							<!DOCTYPE html>
							<html lang="en">

							  <head>
								<meta charset="utf-8">
								<meta name="viewport" content="width=device-width">
								<meta name="description" content="blank">
								<meta name="keywords" content="#">
								<meta name="author" content="Joseph Hentges">
								<title>Firebase HTML Login</title>
								<link href="img/icon.png" rel="icon" type="image/x-icon" />
								<link rel="stylesheet" href="./css/loginStyle.css">
								
								<script src="firebase given url code"></script>
								<script>
									// Initialize Firebase
									// All given by Firebase Account
									var config = {
										apiKey: "",
										authDomain: "",
										databaseURL: "",
										projectId: "",
										storageBucket: "",
										messagingSenderId: ""
									};
									firebase.initializeApp(config);
								</script>
							  </head>

							  <body id="top">

								<div class="login-page">
								  <div class="form">
									<div class="login-form">

									  <p id="error" style="font-size:15px; color:#FF3C3C"><p>
									  <input type="text" style="text-align:center" placeholder="email address" id="txtEmail"/>

									  <input type="password" style="text-align:center" placeholder="password" id="txtPassword"/>

									  <button id="btnSignin" class="btn btn-secondary">login</button>

									  <p style="font-size:15px" class="message">Not registered? <a href="register.html">Create an account</a></p>

									  <p style="font-size:15px" class="message"><a href="forgotpassword.html">Forgot password?</a></p>

									</div>
								  </div>
								</div>


							  </body>

							  <script> 
								var txtEmail = document.getElementById("txtEmail");
								var txtPassword = document.getElementById("txtPassword");
								var btnSignin = document.getElementById("btnSignin");
								
								btnSignin.addEventListener("click", e => 
								{
									var error = document.getElementById("error").innerHTML = "";
									
									const email = txtEmail.value;
									const password = txtPassword.value;
									const auth = firebase.auth();
									
									const promise = auth.signInWithEmailAndPassword(email, password);
									promise
										.catch(error => {
											var error = document.getElementById("error");
											error.innerHTML += "Invalid email or password";
										});
								});
							  </script>
							  <script>
								var newPostKey = firebase.database().ref();
								
								firebase.auth().onAuthStateChanged(firebaseUser => {
									if (firebaseUser) 
									{
										window.open("redirection.html","_self");
									} else 
									{
										console.log(firebaseUser);
									}
								});
							  </script>
							</html>
						</pre>
					</section>
					<section id="firebase-register-page">
						<p class="addSpace">&nbsp;</p>
						<h2 class="title">HTML & Firebase Code | Register Page</h2>
						<p class="fifteen">This code shows a simple HTML Webpage for registering user using Firebase databases.</p>
						<pre class="brush: html">
							<!DOCTYPE html>
							<html lang="en">

							  <head>
								<meta charset="utf-8">
								<meta name="viewport" content="width=device-width">
								<meta name="description" content="blank">
								<meta name="keywords" content="manage, events, event manager, calender mobile, app, mobile app, iphone, android, free, subcription">
								<meta name="author" content="Joseph Hentges">
								<title>Firebase HTML Register</title>
								<link href="img/icon.png" rel="icon" type="image/x-icon" />
								<link rel="stylesheet" href="loginStyle.css">
								
								<script src="firebase given url code"></script>
								<script>
									// Initialize Firebase
									// All given by Firebase Account
									var config = {
										apiKey: "",
										authDomain: "",
										databaseURL: "",
										projectId: "",
										storageBucket: "",
										messagingSenderId: ""
									};
									firebase.initializeApp(config);
								</script>
							  </head>

							  <body id="top">
								<div class="login-page">
								  <div class="form">
									<div class="login-form">
										
									  <p id="error" style="font-size:15px; color:#FF3C3C"><p>
									  <input type="text" style="text-align:center" placeholder="email address" id="txtEmail"/>
										
									  <input type="password" style="text-align:center" placeholder="password" id="txtPassword"/>
										
									  <input type="password" style="text-align:center" placeholder="verify password" id="txtVerifyPassword"/>							

									  <button id="btnSignup">create</button>

									  <p style="font-size:15px" class="message">Already registered? <a href="login.html">Sign In</a></p>


									</div>
								  </div>
								</div>

							  </body>
							  
							  <script>
								var txtEmail = document.getElementById("txtEmail");
								var txtPassword = document.getElementById("txtPassword");
								var txtVerifyPassword = document.getElementById("txtVerifyPassword");
								var btnSignup = document.getElementById("btnSignup");
								
								btnSignup.addEventListener("click", function()
								{	
									var error = document.getElementById("error").innerHTML = "";
									var errors = 0;
									
									//Get the values from the elements
									const email = txtEmail.value;
									const password = txtPassword.value;
									const verifyPassword = txtVerifyPassword.value;
									const auth = firebase.auth(); //Call Firebase
									
									//Check if the passwords entered (password and varifyPassword) are equal
									if(password != verifyPassword)
									{
										var error = document.getElementById("error");
										if(errors >= 1)
										{
											error.innerHTML += "<br/>Password are not the same";
										}else {
											error.innerHTML += "Password are not the same";
										}
										return;
									}
									
									if(email.length == 0)
									{
										var error = document.getElementById("error");
										if(errors >= 1)
										{
											error.innerHTML += "<br/>Email field is not filled";
										}else {
											error.innerHTML += "Email field is not filled";
										}
										return;
									}
									
									//If everything passes - create the user with the email and password entered by the user
									//Check for errors, alert the user of them, and return
									var errorCheck = false;
									var errorCode;
									const promise = auth.createUserWithEmailAndPassword(email, password);
									promise
										.catch(error => {
											errorCode = error.code;
											errorCheck = true;
											
											if(errorCheck)
											{
												if(errorCode == "auth/email-already-in-use")
												{
													var error = document.getElementById("error");
													if(errors >= 1)
													{
														error.innerHTML += "<br/>Email is already in use";
													}else {
														error.innerHTML += "Email is already in use";
													}
													return;
												} else if(errorCode == "auth/weak-password")
												{
													var error = document.getElementById("error");
													if(errors >= 1)
													{
														error.innerHTML += "<br/>Password is too weak, must be 6 characters long";
													}else {
														error.innerHTML += "Password is too weak, must be 6 characters long";
													}
													return;
												} else if(errorCode == "auth/invalid-email")
												{
													var error = document.getElementById("error");
													if(errors >= 1)
													{
														error.innerHTML += "<br/>Email is invalid";
													}else {
														error.innerHTML += "Email is invalid";
													}
													return;
												} else
												{
													console.log(errorCode);
												}	
											}
										});
									promise
										.then(moveon());
										
									function moveon()
									{
										window.open("login.html","_self");
									}
								});
							  </script>
							</html>
						</pre>
					</section>
					<section id="firebase-css-code">
						<p class="addSpace">&nbsp;</p>
						<h2 class="title">HTML Page Stylizing | CSS Code</h2>
						<p class="fifteen">This code shows some simple CSS coding for formating/stylizing a webpage. </p>
						<pre class="brush: css">
							@import url(https://fonts.googleapis.com/css?family=Roboto:300);

							.login-page {
							  width: 360px;
							  padding: 8% 0 0;
							  margin: auto;
							}

							.login-page2 {
							  width: 1000px;
							  padding: 8% 0 0;
							  margin: auto;
							}

							img {
							  margin: 5px;
							}
							.form {
							  position: relative;
							  z-index: 1;
							  background: #FFFFFF;
							  max-width: 360px;
							  margin: 0 auto 100px;
							  padding: 45px;
							  text-align: center;
							  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
							}
							.form input {
							  font-family: "Roboto", sans-serif;
							  outline: 0;
							  background: #f2f2f2;
							  width: 100%;
							  border: 0;
							  margin: 0 0 15px;
							  padding: 15px;
							  box-sizing: border-box;
							  font-size: 14px;
							}
							.form button {
							  font-family: "Roboto", sans-serif;
							  text-transform: uppercase;
							  outline: 0;
							  background: #4CAF50;
							  width: 100%;
							  border: 0;
							  padding: 15px;
							  color: #FFFFFF;
							  font-size: 14px;
							  -webkit-transition: all 0.3 ease;
							  transition: all 0.3 ease;
							  cursor: pointer;
							}
							.form button:hover,.form button:active,.form button:focus {
							  background: #43A047;
							}
							.form .message {
							  margin: 15px 0 0;
							  color: #b3b3b3;
							  font-size: 12px;
							}
							.form .message a {
							  color: #4CAF50;
							  text-decoration: none;
							}
							.form .register-form {
							  display: none;
							}
							.container {
							  position: relative;
							  z-index: 1;
							  max-width: 300px;
							  margin: 0 auto;
							}
							.container:before, .container:after {
							  content: "";
							  display: block;
							  clear: both;
							}
							.container .info {
							  margin: 50px auto;
							  text-align: center;
							}
							.container .info h1 {
							  margin: 0 0 15px;
							  padding: 0;
							  font-size: 36px;
							  font-weight: 300;
							  color: #1a1a1a;
							}
							.container .info span {
							  color: #4d4d4d;
							  font-size: 12px;
							}
							.container .info span a {
							  color: #000000;
							  text-decoration: none;
							}
							.container .info span .fa {
							  color: #EF3B3A;
							}
							body {
							  background: #353e4f; /* fallback for old browsers */
							  background: -webkit-linear-gradient(right, #353e4f, #ffffff);
							  background: -moz-linear-gradient(right, #353e4f, #ffffff);
							  background: -o-linear-gradient(right, #353e4f, #ffffff;
							  background: linear-gradient(to left, #353e4f, #ffffff);
							  font-family: "Roboto", sans-serif;
							  -webkit-font-smoothing: antialiased;
							  -moz-osx-font-smoothing: grayscale;
							}
						</pre>
					</section>
		        </section>
				
				<section id="python-package-installer">
					<div class="content-header">
		                <h1>Python Package Installer | Python Packages</h1>
						</br>
						<h3>Programming Language : Python</h3>
                    </div>
					<div class="welcome">                      
                        <h2 class="twenty">A Program To Automatically Install Python Packages</h2>
						<p>This is a python program built to install python packages automatically.</p>
                        <p>Typically, this program is called from some other program if packages are needed to run it. I use it most often if testing a program on different computers, and want to quickly install the packages I need.</p>
		            </div>				
					<div class="welcome">       
                        <h2 class="twenty">Files Used / Created</h2>
                        <p>Download them below. Bold represents program files, unbold: input files.</p>
						<p>The txt file, Packages.txt, are the packages that you want the program to install.</p>
		            </div>
					<div class="script-source">
		                <ul>
		                    <b><li><a href="project-files/page1/python-package-installer/INSTALLER.py" download>INSTALLER.py</a></li></b>
							<li><a href="project-files/page1/python-package-installer/Packages.txt" download>Packages.txt</a></li>
		                </ul>
		            </div>
					
					<h2 class="title">Installer Program</h2>
		            <p class="fifteen">This program takes in a text file, filled with package names, and automatically installs them.</p>
		            <script type="syntaxhighlighter" class="brush: python">
						import pip
						import imp

						def main():
							packageList = [] #array to hold package name
							package_list = open('Packages.txt', 'r')
							for line in package_list:
								packageList.append(line.replace('\n', ''))
							print(packageList)
							package_list.close()
							for i in range(len(packageList)):
								try:
									imp.find_module(packageList[i])
									found = True
									print('True')
								except ImportError:
									found = False
									print('False')
								if found == False:
									install(packageList[i])
								else:
									print('Package Already Installed.')

						def install(package):
							import importlib
							try:
								importlib.import_module(package)
							except ImportError:
								import pip
								pip.main(['install', package])
							finally:
								globals()[package] = importlib.import_module(package)

						main()
		            </script>					
		        </section>
				
				<section id="python-stock-web-scraper">
					<div class="content-header">
		                <h1>Python Web Scraper | Stock Market Data Scraper</h1>
						</br>
						<h3>Programming Language : Python</h3>
                    </div>
					<div class="welcome">                      
                        <h2 class="twenty">A Program To Automatically Gather Data on Stocks</h2>
						<p>This is a python program built to automatically watch stocks in the stock market and log their data.</p>
						<p>I created this program when I was still learning Python, mainly as a way to test different things and learn about the language.</p>
                        <p>This program does run, however I have ran into some problems with consolidating data at the end of a day. When I have more time I hope to finish this program, as well as restructure it; but as it is, it does work.</p>
						<p>In the code below, I'm displaying only a few of the important files, but the rest can be downloaded.</p>
					</div>				
					<div class="welcome">       
                        <h2 class="twenty">Files Used / Created</h2>
                        <p>Download them below. Bold represents program files, unbold: input files.</p>
						<p>The txt file, Stock_Symbols.txt, are the stocks that you want the program to watch / gather data on.</p>
						<p>The ZIP file, STOCK_WEB_SCRAPER.zip, is a zip file containing all of the files </p>
		            </div>
					<div class="script-source">
		                <ul>
							<b><li><a href="project-files/page1/python-stock-web-scraper/STOCK_WEB_SCRAPER.zip" download>STOCK_WEB_SCRAPER.zip</a></li></b>
		                    <b><li><a href="project-files/page1/python-stock-web-scraper/Initializer.py" download>Initializer.py</a></li></b>
							<b><li><a href="project-files/page1/python-stock-web-scraper/INSTALLER.py" download>INSTALLER.py</a></li></b>
							<b><li><a href="project-files/page1/python-stock-web-scraper/Stock_Price_Grab.py" download>Stock_Price_Grab.py</a></li></b>
							<b><li><a href="project-files/page1/python-stock-web-scraper/Gather_Information_Functions.py" download>Gather_Information_Functions.py</a></li></b>
							<b><li><a href="project-files/page1/python-stock-web-scraper/Gather_Information.py" download>Gather_Information.py</a></li></b>
							<b><li><a href="project-files/page1/python-stock-web-scraper/Save_Daily_Data.py" download>Save_Daily_Data.py</a></li></b>
							<b><li><a href="project-files/page1/python-stock-web-scraper/Excel_Daily_Updater.py" download>Excel_Daily_Updater.py</a></li></b>
							<b><li><a href="project-files/page1/python-stock-web-scraper/Packages.txt" download>Packages.txt</a></li></b>
							<b><li><a href="project-files/page1/python-stock-web-scraper/README.txt" download>README.txt</a></li></b>
							<li><a href="project-files/page1/python-stock-web-scraper/Stock_Symbols.txt" download>Stock_Symbols.txt</a></li>
		                </ul>
		            </div>
					<section id="python-stock-web-scraper-initializer">
						<p class="addSpace">&nbsp;</p>
						<h2 class="title">Initializer</h2>
						<p class="fifteen">This is where the program will begin. Open it to begin the program.</p>
						<script type="syntaxhighlighter" class="brush: python">
							import json
							import requests
							import os
							import os.path
							import xlwt
							import xlrd
							import Stock_Price_Grab    #Importing script <--
							import Excel_Daily_Updater #Importing script <--
							import INSTALLER #Import the installer for installing script packages
							import datetime
							import time

							#Call the grabStock function from the Stock_Price_Grab script
							def callStockGrab(stock):
								#Call the stock grab for 'stock'
								service = Stock_Price_Grab.grabStock(stock) #Returns whether the information was available or not
								return service


							#Check for, and create the text file holding temperary information
							def checkTextFilePath(stock):
								fileName = 'lastInformation_'+stock.upper()+'.txt'
								if not os.path.exists(fileName):
									file = open(fileName, 'w+')
									file.close()

							#Remove the temperary text files
							def removeTextFilePath(stock):
								fileName = 'lastInformation_'+stock.upper()+'.txt'
								if os.path.exists(fileName):
									os.remove(fileName)

							#Check if starting excel file excists, create if it does not
							def checkExcelFile(stock):
								#File location for the daily changing excel sheet
								excelSheet = 'Excel_Files/'+stock.upper()+'/Excel_Sheet_'+stock.upper()+'_Full_Data.xls'
								book = xlwt.Workbook()
								
								#If the file does not exist, create the file with titles in row 0
								if not os.path.exists(excelSheet):
									os.makedirs(os.path.dirname(excelSheet))
									sheet = book.add_sheet('Sheet')
									sheet.write(0,0,'Date')
									sheet.write(0,1,'Time In Seconds')
									sheet.write(0,2,'Current Price')
									sheet.write(0,3,'Price Change')
									sheet.write(0,4,'Change Percentage')
									sheet.write(0,5,'Opening Price')
									sheet.write(0,6,'Lowest Price')
									sheet.write(0,7,'Highest Price')
									sheet.write(0,8,'Traded Today')
									sheet.write(0,9,'Daily Traded Average')
									sheet.write(0,10,'52 Week Low Price')
									sheet.write(0,11,'52 Week High Price')
									sheet.write(0,12,'Price/Earnings Ratio')
									sheet.write(0,13,'Earnings Per Share')
									sheet.write(0,14,'Yield')
									sheet.write(0,15,'Dividend')
									sheet.write(0,16,'Outstanding Shares')
									sheet.write(0,17,'Market Cap')
									sheet.write(0,18,'Beta')
									sheet.write(0,19,'Institutional Ownership')
									book.save(excelSheet)    

							#Get the starting row from each stock excel file
							def checkStartRow(stock):
								excelSheet = 'Excel_Files/'+stock.upper()+'/Excel_Sheet_'+stock.upper()+'_Full_Data.xls'
								workbookOpen = xlrd.open_workbook(excelSheet)
								sheets = workbookOpen.sheets()
								rows = sheets[0].nrows #Number of rows in the excel sheet
								return rows

							INSTALLER.main()

							fileText = input("Enter the file with stock symbols: ")
							fileText = fileText+'.txt'

							x = True #Infinate loop
							while x:
								#Get the time in seconds
								second = int(datetime.datetime.now().strftime('%S'))
								minute = int(datetime.datetime.now().strftime('%M'))
								hour = int(datetime.datetime.now().strftime('%H'))
								todayTime = second + (minute*60) + (hour*60*60) #Todays time in seconds
								inMarket = True #Boolean to hold T/F for stock market in time
								if not (todayTime >= 30600 and todayTime < 54000):
									print('Time is outside Stock Market Availability. Pausing for 10 minutes...')
									time.sleep(600) #Pause the script for 10 minutes

								#If the time is within the stock market operating hours, continue
								if(todayTime >= 30600 and todayTime < 54000):
									stocks = [] #Array to hold stock symbols
									counter = 0 #Counter to indicate when to update the 'startRow' varaible
									startRowNumber = [] #Array to hold the excel file starting row number for each stock
									
									numberOfStocks = 0 #Counter for the number of stocks
									#Open text file holding stock symbols
									#Add stock to 'stocks' array, and add 1 to counter
									file = open(fileText, 'r')
									for line in file:
										stocks.append(line.replace('\n', '')) #Add to array
										numberOfStocks += 1 #Increment counter
									file.close()

									while inMarket:      
										second2 = int(datetime.datetime.now().strftime('%S'))
										minute2 = int(datetime.datetime.now().strftime('%M'))
										hour2 = int(datetime.datetime.now().strftime('%H'))
										todayTime2 = second2 + (minute2*60) + (hour2*60*60)
										print(datetime.datetime.now().strftime('It is | %H:%M:%S'))
										for i in range(numberOfStocks):
											#Check for excel file existance
											checkExcelFile(stocks[i])
											
											#If 'counter' = 0, update the startRow variable
											if counter == 0:
												startRowNumber.append(checkStartRow(stocks[i]))
											
											checkTextFilePath(stocks[i])
											service = callStockGrab(stocks[i])
											if(service == True and todayTime2 < 54000 and todayTime2 > 30600):
												print('The market is unavailable, pausing for 5 minutes...')
												time.sleep(300)
										time.sleep(10) #Pause the script for 10 seconds
										
										if(todayTime2 > 54000):
											inMarket = False
											break

										counter +=1 #Itterate the counter

									print('Finalized Data')
									print()
									for i in range(numberOfStocks):
										removeTextFilePath(stocks[i])
										Excel_Daily_Updater.start(stocks[i], startRowNumber[i])
										
									print('The market is now out.')
						</script>
					</section>
					<section id="python-stock-web-scraper-stock-grabber">
						<p class="addSpace">&nbsp;</p>
						<h2 class="title">Stock Price Grab</h2>
						<p class="fifteen">This is how the stock data is gathered from the web. It gathers it from Google Finance and enters it into an Excel file.</p>
						<script type="syntaxhighlighter" class="brush: python">
							import json
							import requests
							import os
							import os.path
							import xlwt
							import xlrd
							from xlutils.copy import copy
							import datetime

							def grabStock(stock):
								#Get the link
								rsp = requests.get('https://finance.google.com/finance?q=' + stock + '&output=json')
								if(rsp.reason == 'Service Unavailable'):
									 return True #The json service is no longer available
												 #Retuning True to pause the script for 10 minutes
								if rsp.status_code in (200,):

									#File location for the daily changing excel sheet
									excelSheet = 'Excel_Files/'+stock.upper()+'/Excel_Sheet_'+stock.upper()+'_Full_Data.xls'
									book = xlwt.Workbook()

									#Get the number of rows currently used in the excel sheet
									#Used for placing new data
									workbookOpen = xlrd.open_workbook(excelSheet)
									sheets = workbookOpen.sheets()
									rows = sheets[0].nrows #Number of rows in the excel sheet
									
									last = 0.0 #The last price placed in the excel sheet
									stockRange = 0.0 #The range between the last price and current price

									fin_data = json.loads(rsp.content[6:-2].decode('unicode_escape')) #Gathering the data from the web page
									hold = fin_data['l'] #The current price of the stock
									StockCompany = fin_data['name'] #The company name
									priceDifference = 0.0 #The value used to mark when to add new data to the excel file
									if(float(hold) > 75.00): #If above $75, add data when the last record and current price are $0.10 apart
										priceDifference = 0.10
									elif(float(hold) > 35.00):
										priceDifference = 0.06
									else:
										priceDifference = 0.02

									#To add another price range slot it in where it should be and fill in this (remove the pound symbols):
									#elif(float(hold) > stockPrice):
									#   priceDifference = priceDifference

									lastInformation = 'lastInformation_'+stock.upper()+'.txt' #File used to hold information from the last iteration of the script

									#Gather data from the lastInformation text file
									with open(lastInformation, 'r') as fp:
										for line in fp:
											last = float(line.replace('\n', ''))
									fp.close()
									
									stockRange = abs(last - float(hold)) #Get the price difference from the last and current recordings. Compared with the hard coded price differences
									now = datetime.datetime.now() #Get the date
									
									#Print out basic current information
									print('Company: ' + StockCompany)
									print('Last: ' + str(last) + ' - ' + str(hold))
									print('Stock Range: ' + str(stockRange))
									print()

									#If the price difference that was hard coded above is less than the stock range, add this information to the excel file
									#Otherwise skip, and run again in 10 seconds
									if(priceDifference < stockRange):

										#get sentiment analysis information
										
										rb = xlrd.open_workbook(excelSheet) #Open the excel file
										sh = copy(rb) #Copy the file to a writable doc
										sh_sheet = sh.get_sheet(0) #Use sheet 0
										#Write to the database on the next available row
										sh_sheet.write(rows,0,now.strftime("%m/%d/%Y | %H:%M"))

										#Get and set the time in seconds
										now = datetime.datetime.now()
										second = int(now.strftime('%S'))
										minute = int(now.strftime('%M'))
										hour = int(now.strftime('%H'))
										todayTime = second + (minute*60) + (hour*60*60) #Todays time in seconds
										sh_sheet.write(rows,1,todayTime)
										
										sh_sheet.write(rows,2,float(format(fin_data['l'])))
										sh_sheet.write(rows,3,float(format(fin_data['c'])))
										sh_sheet.write(rows,4,float(format(fin_data['cp'])))
										sh_sheet.write(rows,5,float(format(fin_data['op'])))
										sh_sheet.write(rows,6,float(format(fin_data['lo'])))
										sh_sheet.write(rows,7,float(format(fin_data['hi'])))

										#Get the volume traded today, and change to integer if string
										#If in millions (m), multiply value by 10^6
										#If in billions (b), multiply value by 10^9
										tradedChange = 0;
										if 'M' in format(fin_data['vo']):
											tradedChange = float(format(fin_data['vo'].replace('M', ''))) * 10**6
										if 'B' in format(fin_data['vo']):
											tradedChange = float(format(fin_data['vo']).replace('B', '')) * 10**9
										sh_sheet.write(rows,8,tradedChange)

										#Get the volume traded average, and change to integer if string
										#If in millions (m), multiply value by 10^6
										#If in billions (b), multiply value by 10^9
										tradedAverageChange = 0;
										if 'M' in format(fin_data['avvo']):
											tradedAverageChange = float(format(fin_data['avvo']).replace('M', '')) * 10**6
										if 'B' in format(fin_data['avvo']):
											tradedAverageChange = float(format(fin_data['avvo']).replace('B', '')) * 10**9
										sh_sheet.write(rows,9,tradedAverageChange)
										
										sh_sheet.write(rows,10,float(format(fin_data['lo52'])))
										sh_sheet.write(rows,11,float(format(fin_data['hi52'])))

										#Change Price/Earnings Ratio to a float
										if '.' in format(fin_data['pe']):
											peChange = float(format(fin_data['pe']))
										else:
											peChange = '-'
										sh_sheet.write(rows,12,peChange)
										
										sh_sheet.write(rows,13,float(format(fin_data['eps'])))

										if '.' in format(fin_data['dy']):
											dyChange = float(format(fin_data['dy']))
										else:
											dyChange = '-'
										sh_sheet.write(rows,14,dyChange)

										if '.' in format(fin_data['ldiv']):
											ldivChange = float(format(fin_data['ldiv']))
										else:
											ldivChange = '-'
										sh_sheet.write(rows,15,ldivChange)

										#Get the total number of shares available, and change to integer if string
										#If in millions (m), multiply value by 10^6
										#If in billions (b), multiply value by 10^9
										sharesChange = 0;
										if 'M' in format(fin_data['shares']):
											sharesChange = float(format(fin_data['shares']).replace('M', '')) * 10**6
										if 'B' in format(fin_data['shares']):
											sharesChange = float(format(fin_data['shares']).replace('B', '')) * 10**9
										sh_sheet.write(rows,16,sharesChange)

										#Get the Market Cap, and change to integer if string
										#If in millions (m), multiply value by 10^6
										#If in billions (b), multiply value by 10^9
										marketCapChange = 0;
										if 'M' in format(fin_data['mc']):
											sharesChange = float(format(fin_data['mc']).replace('M', '')) * 10**6
										if 'B' in format(fin_data['mc']):
											marketCapChange = float(format(fin_data['mc']).replace('B', '')) * 10**9
										sh_sheet.write(rows,17,marketCapChange)
										
										sh_sheet.write(rows,18,float(format(fin_data['beta'])))
										
										#Change the % to decimal (e.i 62% to 0.62)
										instOwnChange = 0
										instString = format(fin_data['instown']).replace('%', '')
										instOwnChange = float(instString) * 10**-2
										sh_sheet.write(rows,19,instOwnChange)
										
										#Format the columns to 20 characters wide
										for i in range(20):
											sh_sheet.col(i).width = 20*256
										sh.save(excelSheet) #Save the excel file

										#Print out the information gathered to the console
										print('Current Price: {}'.format(fin_data['l']))
										print('Change: {}'.format(fin_data['c']))
										print('Change Percentage: {}'.format(fin_data['cp']))
										print('Opening Price: {}'.format(fin_data['op']))
										print('Price/Earnings Ratio: {}'.format(fin_data['pe']))
										print('52-week high: {}'.format(fin_data['hi52']))
										print('52-week low: {}'.format(fin_data['lo52']))
										print('Outstanding Shares: {}'.format(fin_data['shares']))
										print('Highest Price: {}'.format(fin_data['hi']))
										print('Lowest Price: {}'.format(fin_data['lo']))
										print('Yeild: {}'.format(fin_data['dy']))
										print('Dividend: {}'.format(fin_data['ldiv']))
										print('Earnings Per Share: {}'.format(fin_data['eps']))
										print('Beta: {}'.format(fin_data['beta']))
										print('Institutional Ownership: {}'.format(fin_data['instown']))
										print('Market Cap: {}'.format(fin_data['mc']))
										print('Daily Traded Average: {}'.format(fin_data['avvo']))
										print('Traded Today: {}'.format(fin_data['vo']))
										print()

										#Update the lastInformation text file with new data
										file2 = open(lastInformation, 'w+')
										file2.write(hold)
										file2.close()
									print('-------------------------------------------------------------')
									print()
									#Check back with Start Up script to see if restarting
									return False #The json service is still available
						</script>
					</section>
		        </section>
		        
		        <section id="end">
					<div class="content-header">
		                <a class="dead-arrow" href="projects-1"><i class="fa fa-arrow-left"></i></a>
						<u><a class="" href="projects-1">1</a></u>
						<a class="dead-arrow" href="#"><i class="fa fa-arrow-right"></i></a>
                    </div>
		        </section>
		    </div>
		</div>
		
		
		<!-- Essential JavaScript Libraries
		==============================================-->
        <script type="text/javascript" src="../js/jquery-1.11.0.min.js"></script>
        <script type="text/javascript" src="../js/jquery.nav.js"></script>
        <script type="text/javascript" src="../syntax-highlighter/scripts/shCore.js"></script> 
        <script type="text/javascript" src="../syntax-highlighter/scripts/shBrushXml.js"></script> 
        <script type="text/javascript" src="../syntax-highlighter/scripts/shBrushCss.js"></script> 
        <script type="text/javascript" src="../syntax-highlighter/scripts/shBrushJScript.js"></script> 
        <script type="text/javascript" src="../syntax-highlighter/scripts/shBrushPhp.js"></script> 
		<script type="text/javascript" src="../syntax-highlighter/scripts/shBrushPython.js"></script> 
        <script type="text/javascript">
            SyntaxHighlighter.all()
        </script>
        <script type="text/javascript" src="../js/custom.js"></script>
		
    </body>
</html>
